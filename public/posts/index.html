<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Posts | Sage&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="Posts - Sage&#39;s Blog">
<meta name="author" content="Sage">
<link rel="canonical" href="https://blog.sa1ge.ink/posts/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8f0c19e94e0c41178f936e6369d0c8348589ec38ba85365ea770d94d6051aee9.css" integrity="sha256-jwwZ6U4MQRePk25jadDINIWJ7Di6hTZep3DZTWBRruk=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blog.sa1ge.ink/assets/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.sa1ge.ink/assets/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.sa1ge.ink/assets/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.sa1ge.ink/assets/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.sa1ge.ink/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://blog.sa1ge.ink/posts/index.xml">
<link rel="alternate" hreflang="en" href="https://blog.sa1ge.ink/posts/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/style.css" />
<link rel="stylesheet" href="/css/custom-font.css">







<meta property="og:url" content="https://blog.sa1ge.ink/posts/">
  <meta property="og:site_name" content="Sage&#39;s Blog">
  <meta property="og:title" content="Posts">
  <meta property="og:description" content="A blog about Sage&#39;s adventures in coding and life.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Posts">
<meta name="twitter:description" content="A blog about Sage&#39;s adventures in coding and life.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://blog.sa1ge.ink/posts/"
    }
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.sa1ge.ink/" accesskey="h" title="Sage&#39;s Blog (Alt + H)">Sage&#39;s Blog</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.sa1ge.ink/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://blog.sa1ge.ink/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://blog.sa1ge.ink/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://blog.sa1ge.ink/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://blog.sa1ge.ink/">Home</a></div>
  <h1>
    Posts
    <a href="/posts/index.xml" title="RSS" aria-label="RSS">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round" height="23">
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
  </h1>
</header>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Attention
    </h2>
  </header>
  <div class="entry-content">
    <p>此处提供一张思维导图。 思维导图
(Generated by NoteBookLLM)
为什么需要注意力机制 传统的 Seq2Seq 模型(此处以 RNN 的 Encoder - Decoder 模型为例)，会将输入序列压缩为一个定长的向量，解码器再从这个向量生成输出序列。但是定长的向量难以有效编码所有必要的信息，那么就成为了处理长句子的瓶颈。
注意力机制的具体运作 注意力机制将输入编码成一个向量序列(annotations)。在生成输出序列的每个词的时候，模型会软搜索输入序列中的相关位置，根据这些相关的上下文向量和之前已经生成的目标词来预测下一个目标词。
缩放点积注意力(SDPA) $$ Atten(Q,K,V)=softmax\left( \frac{QK^T}{\sqrt{ d_{k} }} \right)V \tag{1} $$
注意力机制的核心在于计算一个上下文向量$(Atten(Q,K,V))$，这个向量是输入序列的加权和，权重反应了输入序列中每个部分对于生成序列当前输出词的重要性。 在Scaled Dot-Product Attention 中，首先计算 query 和 key 的关联性，然后将这个关联性作为value 的权重，各个权重与 value 的乘积相加得到输出。(公式 1) $\sqrt{ d_{k} }$作用是缩放注意力分数。因为当$d_{k}$很大的时候，点积$QK^T$的结果会很大，导致 Softmax 产生极度不均匀的分布，梯度会变得很小。 代码实现 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 import torch import torch.nn as nn class ScaledDotProductAttention(nn.Module): def __init__(self): super(ScaledDotProductAttention, self).__init__() def forward(self, query, key, value, causal_mask=None,padding_mask=None): &#34;&#34;&#34; Single-head Scaled Dot-Product Attention Args: query: Query tensor of shape (batch_size, seq_len_q, d_k) key: Key tensor of shape (batch_size, seq_len_k, d_k) value: Value tensor of shape (batch_size, seq_len_v, d_v) causal_mask: Optional causal mask tensor of shape (batch_size, seq_len_q, seq_len_k) padding_mask: Optional padding mask tensor of shape (batch_size, seq_len_q, seq_len_k) 1. Causal mask is used to prevent attending to future tokens in the sequence. 2. Padding mask is used to ignore padding tokens in the sequence. 3. Both masks are optional and can be None. Returns: attention_output: Attention weighted output tensor of shape (batch_size, seq_len_q, d_v) &#34;&#34;&#34; d_k = query.size(-1) # Hidden size of the key/query attention_scores = torch.matmul(query,key.transpose(-1,-2)) / torch.sqrt(torch.tensor(d_k,dtype=torch.float32)) if causal_mask is not None: attention_scores = attention_scores.masked_fill(causal_mask == 0, float(&#39;-inf&#39;)) if padding_mask is not None: attention_scores = attention_scores.masked_fill(padding_mask == 0, float(&#39;-inf&#39;)) attention_weights = torch.softmax(attention_scores, dim=-1) attention_output = torch.matmul(attention_weights, value) return attention_output def test(): batch_size = 8 seq_len = 16 hidden_size = 64 query = torch.randn(batch_size,seq_len,hidden_size) key = torch.randn(batch_size,seq_len,hidden_size) value = torch.randn(batch_size,seq_len,hidden_size) sdpa = ScaledDotProductAttention() output = sdpa(query, key, value) print(&#34;Query shape:&#34;, query.shape) print(&#34;Key shape:&#34;, key.shape) print(&#34;Value shape:&#34;, value.shape) print(&#34;Output shape:&#34;, output.shape) if __name__ == &#34;__main__&#34;: test() ...</p>
  </div>
  <footer class="entry-footer">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>
            &nbsp;发布&nbsp;May 31, 2025
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_2">
        <span class="fa fa-calendar-plus-o"></span>
        <span>
            &nbsp;最后一次修改&nbsp;May 31, 2025
            &nbsp;|&nbsp;
        </span>
    </span>
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>364字
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>2分钟
            &nbsp;&nbsp;
        </span>
    </span>
    
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
        </span>
    </span>
</span></footer>
  <a class="entry-link" aria-label="post link to Attention" href="https://blog.sa1ge.ink/posts/attention/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Exp Migrate From Hexo to Hugo
    </h2>
  </header>
  <div class="entry-content">
    <p> 好看是第一要义。
原因 最近半年换了不少设备，从Windows 主力换到了 M4MacMini ，个人感觉提升还是很大的，除了便携性这一方面比较差。Windows 重装之后发现把之前 Blog 的内容全部都丢弃了，要找只能从之前生成的静态网页去翻，但是鉴于我之前写的东西没啥价值且公式又多，所以干脆直接抛弃&#43;迁移。
一些样式的配置参考 Github 小卡片 awesome-project 一个很棒的开源项目 Go 在 assets/css/extended 中创建 github.css css 代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 .github { border: 1px solid var(--border); border-radius: 12px; width: 100%; margin: 1.5em 0; padding: 1em; background: linear-gradient(135deg, var(--code-bg) 0%, rgba(255, 255, 255, 0.02) 100%); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); transition: all 0.3s ease; position: relative; overflow: hidden; &amp;::before { content: &#39;&#39;; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, #0366d6, #28a745, #ffd33d, #f66a0a); opacity: 0.8; } &amp;:hover { transform: translateY(-3px); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12); border-color: rgba(3, 102, 214, 0.3); } .github_bar { display: flex; align-items: center; margin-bottom: 1em; .github-icon { width: 22px; height: 22px; margin-right: 10px; fill: #6c757d; transition: fill 0.3s ease; } } .github_name { font-weight: 600; text-decoration: none; font-size: 1.3rem; color: #0366d6; transition: all 0.3s ease; position: relative; &amp;:hover { color: #0256cc; transform: translateX(2px); } &amp;::after { content: &#39;&#39;; position: absolute; width: 0; height: 2px; bottom: -2px; left: 0; background: linear-gradient(90deg, #0366d6, #28a745); transition: width 0.3s ease; } &amp;:hover::after { width: 100%; } } .github_description { color: #586069; font-size: 0.95rem; line-height: 1.6; margin-bottom: 1.2em; text-align: left; padding: 0.5em 0; border-left: 3px solid transparent; padding-left: 0.8em; transition: all 0.3s ease; &amp;:hover { border-left-color: rgba(3, 102, 214, 0.3); background: rgba(3, 102, 214, 0.02); } } .github_language { display: inline-flex; align-items: center; background: rgba(3, 102, 214, 0.1); padding: 0.4em 0.8em; border-radius: 20px; border: 1px solid rgba(3, 102, 214, 0.2); transition: all 0.3s ease; &amp;::before { content: &#34;⚡&#34;; margin-right: 6px; font-size: 0.9em; } color: #0366d6; font-size: 0.85rem; font-weight: 500; &amp;:hover { background: rgba(3, 102, 214, 0.15); border-color: rgba(3, 102, 214, 0.4); transform: translateY(-1px); } } } /* 深色模式适配 */ @media (prefers-color-scheme: dark) { .github { background: linear-gradient(135deg, #0d1117 0%, rgba(33, 38, 45, 0.8) 100%); border-color: #30363d; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); &amp;:hover { box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); border-color: rgba(88, 166, 255, 0.3); } .github_bar .github-icon { fill: #8b949e; } .github_name { color: #58a6ff; &amp;:hover { color: #79c0ff; } &amp;::after { background: linear-gradient(90deg, #58a6ff, #56d364); } } .github_description { color: #8b949e; &amp;:hover { border-left-color: rgba(88, 166, 255, 0.3); background: rgba(88, 166, 255, 0.05); } } .github_language { background: rgba(88, 166, 255, 0.1); border-color: rgba(88, 166, 255, 0.2); color: #58a6ff; &amp;:hover { background: rgba(88, 166, 255, 0.15); border-color: rgba(88, 166, 255, 0.4); } } } } /* 响应式设计 */ @media (max-width: 768px) { .github { margin: 1em 0; padding: 1.2em; border-radius: 8px; .github_name { font-size: 1.15rem; } .github_description { font-size: 0.9rem; padding-left: 0.5em; } .github_language { padding: 0.3em 0.6em; font-size: 0.8rem; } } } ...</p>
  </div>
  <footer class="entry-footer">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>
            &nbsp;发布&nbsp;May 31, 2025
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_2">
        <span class="fa fa-calendar-plus-o"></span>
        <span>
            &nbsp;最后一次修改&nbsp;November 20, 2025
            &nbsp;|&nbsp;
        </span>
    </span>
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>688字
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>4分钟
            &nbsp;&nbsp;
        </span>
    </span>
    
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
        </span>
    </span>
</span></footer>
  <a class="entry-link" aria-label="post link to Exp Migrate From Hexo to Hugo" href="https://blog.sa1ge.ink/posts/exp-migrate-from-hexo-to-hugo/"></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://blog.sa1ge.ink/">Sage&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  (function (u, c) {
    var d = document,
      t = "script",
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener("load", function (e) {
        c(e);
      });
    }
    s.parentNode.insertBefore(o, s);
  })("\/js\/pangu.min.js", function () {
    pangu.spacingPage();
  });
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>
